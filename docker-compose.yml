version: '2'

services:
  rails:
    image: cryptopus-dev/rails
    build:
      context: ./config/docker/development
      dockerfile: Rails.dockerfile
    ports:
      - 3000:3000
    volumes:
      - ./:/myapp
      - ./tmp/seed:/seed
      - bundler_cache:/opt/bundle
      - ./config/docker/development/frontend-index.html:/myapp/public/frontend-index.html:ro
  ember:
    image: danlynn/ember-cli:latest
    build:
      context: ./config/docker/development
      dockerfile: Ember.dockerfile
    volumes:
      - ./frontend:/myapp
      - ./tmp/bash_history:/root/.bash_history
      - yarn_cache:/myapp/node_modules
    tmpfs:
      - /myapp/tmp
    ports:
      - "4200:4200"
      - "7020:7020"
      - "7357:7357"
volumes:
  bundler_cache:
  yarn_cache:
