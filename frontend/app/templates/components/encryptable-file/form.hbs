<BsModal class="modal_file_entry" @onHide={{action "abort"}} @renderInPlace="true" @size="lg" as |Modal|>
  <Modal.header>
    <h3 class="modal-title align-middle" id="accountFormModalLabel">{{@title}}</h3>
  </Modal.header>
  <Modal.body>
    <div class="container-fluid">
      {{#each this.errors as |error|}}
        <div class="alert alert-danger modal-alert ">
          {{error.detail}}.<br>
          {{t "encryptable_files.new.reupload"}}
        </div>
      {{/each}}
      <div class="row">
        <div class="form-group col-md-12">
          <div>
            <label>{{t "encryptable_files.new.choose_file"}}</label>
            <div class="dropzone-text">
              {{#unless this.args.attachment}}
                <PowerSelect
                    id="team-dropdown"
                    @options={{this.assignableTeams}}
                    @placeholder={{t "encryptable/credentials.edit.team_placeholder"}}
                    @renderInPlace={{true}}
                    @selected={{this.selectedTeam}}
                    @searchField={{"name"}}
                    @searchEnabled={{true}}
                    @onChange={{fn (mut this.selectedTeam)}} as |team|>
                    {{team.name}}
                  </PowerSelect>
                  <PowerSelect
                    id="folder-dropdown"
                    @options={{this.availableFolders}}
                    @placeholder={{t "encryptable/credentials.edit.folder_placeholder"}}
                    @renderInPlace={{true}}
                    @selected={{this.changeset.folder}}
                    @searchField={{"name"}}
                    @searchEnabled={{true}}
                    @onChange={{fn (mut this.changeset.folder)}} as |folder|>
                    {{folder.name}}
                  </PowerSelect>
              {{/unless}}
              {{#if this.changeset.file}}
                <div class="mb-2">
                  {{t "encryptable_files.new.selected_file"}}: {{this.changeset.file.name}}
                </div>
              {{/if}}
              <div>
                <FileUpload @name="file"
                            @accept="*"
                            @for="upload-file"
                            @multiple={{false}}
                            @onfileadd={{this.uploadFile}}
                            @ondrop={{this.uploadFile}}
                            class="btn btn-primary file-upload-button">
                  <a id="upload-file">{{t (if this.changeset.file "encryptable_files.new.reupload" "encryptable_files.new.upload_file")}}</a>
                </FileUpload>
                {{#let (file-queue name="files" onFileAdded=this.uploadFile) as |queue| }}
                  <input type="file" id="actual-btn" hidden {{queue.selectFile}}>
                  <label class="btn btn-primary w-100" for="actual-btn">
                    {{t (if this.changeset.file "encryptable_files.new.reupload"
                          "encryptable_files.new.upload_file")}}
                  </label>
                {{/let}}
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="form-group col-md-12">
          <label name="description">{{t "description"}}</label>
          <div>
            <Textarea class="form-control vertical-resize" name="description" @value={{this.changeset.description}} />
            <ValidationErrorsList @errors={{this.changeset.error.description.validation}}/>
          </div>
        </div>
      </div>
    </div>
  </Modal.body>
  <Modal.footer>
    <BsButton @onClick={{action this.submit this.changeset}} @type="primary">{{t "encryptable_files.new.upload"}}</BsButton>
    <BsButton @onClick={{action this.abort}} @type="secondary">{{t "close"}}</BsButton>
  </Modal.footer>
</BsModal>
